!function(e){"use strict";Drupal.behaviors.webform=Drupal.behaviors.webform||{},Drupal.behaviors.webform.attach=function(e){Drupal.webform.datepicker(e),Drupal.settings.webform&&Drupal.settings.webform.conditionals&&Drupal.webform.conditional(e)},Drupal.webform=Drupal.webform||{},Drupal.webform.datepicker=function(r){e("div.webform-datepicker").each((function(){var r=e(this),a=r.find("input.webform-calendar");if(0!=a.length){var t=a[0].className.replace(/.*webform-calendar-start-(\d{4}-\d{2}-\d{2}).*/,"$1").split("-"),o=a[0].className.replace(/.*webform-calendar-end-(\d{4}-\d{2}-\d{2}).*/,"$1").split("-"),n=a[0].className.replace(/.*webform-calendar-day-(\d).*/,"$1");if((t=new Date(t[0],t[1]-1,t[2]))>(o=new Date(o[0],o[1]-1,o[2]))){var i=t;t=o,o=i}var l=t.getFullYear(),u=o.getFullYear();a.datepicker({dateFormat:"yy-mm-dd",yearRange:l+":"+u,firstDay:parseInt(n),minDate:t,maxDate:o,onSelect:function(e,a){var t=e.split("-");r.find("select.year, input.year").val(+t[0]).trigger("change"),r.find("select.month").val(+t[1]).trigger("change"),r.find("select.day").val(+t[2]).trigger("change")},beforeShow:function(a,t){var o=r.find("select.year, input.year").val(),n=r.find("select.month").val(),i=r.find("select.day").val(),f=new Date;o=o||f.getFullYear(),n=n||f.getMonth()+1,i=i||f.getDate(),o=o<l||o>u?l:o,e(a).val(o+"-"+n+"-"+i)}}),a.click((function(r){0!==r.clientX&&0!==r.clientY&&(e(this).focus(),r.preventDefault())})),a.keyup((function(r){8!=r.keyCode&&46!=r.keyCode||e.datepicker._clearDate(this)}))}}))},Drupal.webform.conditional=function(r){e.each(Drupal.settings.webform.conditionals,(function(r,a){e("."+r+":not(.webform-conditional-processed)").each((function(r,t){var o=e(t);o.addClass("webform-conditional-processed"),o.bind("change",{settings:a},Drupal.webform.conditionalCheck),Drupal.webform.doConditions(o,a)}))}))},Drupal.webform.conditionalCheck=function(r){var a=e(r.target).closest(".webform-component");if(a.length){var t=a.closest("form"),o=a.attr("class").match(/webform-component--[^ ]+/)[0],n=r.data.settings;n.sourceMap[o]&&Drupal.webform.doConditions(t,n)}},Drupal.webform.doConditions=function(r,a){var t,o;function n(e){o[++t]={results:[],andor:e}}function i(e){o[t].results.push(e)}function l(){var r=o[t];t=Math.max(0,t-1);var a=r.results,n=e.map(a,(function(e){return e||null}));return"or"===r.andor?n.length>0:n.length===a.length}e.each(a.ruleGroups,(function(u,f){var s,c=a.ruleGroups[u];s=c.andor,t=-1,o=[],n(s),e.each(c.rules,(function(e,t){switch(t.source_type){case"component":var o=t.source,u=r.find("."+o)[0],f=a.values[o]?a.values[o]:null;i(window.Drupal.webform[t.callback](u,f,t.value));break;case"conditional_start":n(t.andor);break;case"conditional_end":i(l())}}));var p=l();e.each(c.actions,(function(a,t){var o=r.find("."+t.target),n=t.invert?!p:p;switch(t.action){case"show":var i=n!=Drupal.webform.isVisible(o);n?(o.find(".webform-conditional-disabled:not(.webform-disabled-flag)").removeClass("webform-conditional-disabled").webformProp("disabled",!1),o.removeClass("webform-conditional-hidden").show(),r.find(".chosen-disabled").prev().trigger("chosen:updated.chosen")):o.hide().addClass("webform-conditional-hidden").find(":input").addClass("webform-conditional-disabled webform-disabled-flag").webformProp("disabled",!0),i&&o.is("tr")&&Drupal.webform.restripeTable(o.closest("table").first());break;case"require":var l=o.find(".form-required, .form-optional").first();if(n!=l.hasClass("form-required")){var u=o.find("input:text,textarea,input[type='email'],select,input:radio,input:checkbox,input:file");Drupal.detachBehaviors(l),u.webformProp("required",n).toggleClass("required",n),n?l.replaceWith('<span class="form-required" title="'+Drupal.t("This field is required.")+'">*</span>'):l.replaceWith('<span class="form-optional"></span>'),Drupal.attachBehaviors(l)}break;case"set":var f=o.find("input:text,textarea,input[type='email']"),s=o.find("select,select option,input:radio,input:checkbox"),c=o.filter(".webform-component-markup");if(n){var d=e.map(t.argument.split(","),e.trim);s.webformVal(d).webformProp("disabled",!0).addClass("webform-disabled-flag"),f.val([t.argument]).webformProp("readonly",!0).addClass("webform-disabled-flag"),c.html(t.argument)}else s.not(".webform-disabled-flag").webformProp("disabled",!1),f.not(".webform-disabled-flag").webformProp("readonly",!1),c.each((function(){var r=e(this),a=r.data("webform-markup");void 0!==a&&r.html(a)}))}}))})),r.find(".webform-disabled-flag").removeClass("webform-disabled-flag")},Drupal.webform.stopEvent=function(){return!1},Drupal.webform.conditionalOperatorStringEqual=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){if(r.toLowerCase()===t.toLowerCase())return o=!0,!1})),o},Drupal.webform.conditionalOperatorStringNotEqual=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){r.toLowerCase()===t.toLowerCase()&&(o=!0)})),!o},Drupal.webform.conditionalOperatorStringContains=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){if(r.toLowerCase().indexOf(t.toLowerCase())>-1)return o=!0,!1})),o},Drupal.webform.conditionalOperatorStringDoesNotContain=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){r.toLowerCase().indexOf(t.toLowerCase())>-1&&(o=!0)})),!o},Drupal.webform.conditionalOperatorStringBeginsWith=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){if(0===r.toLowerCase().indexOf(t.toLowerCase()))return o=!0,!1})),o},Drupal.webform.conditionalOperatorStringEndsWith=function(r,a,t){var o=!1,n=Drupal.webform.stringValue(r,a);return e.each(n,(function(e,r){if(r.toLowerCase().lastIndexOf(t.toLowerCase())===r.length-t.length)return o=!0,!1})),o},Drupal.webform.conditionalOperatorStringEmpty=function(r,a,t){var o=Drupal.webform.stringValue(r,a),n=!0;return e.each(o,(function(e,r){if(""!==r)return n=!1,!1})),n},Drupal.webform.conditionalOperatorStringNotEmpty=function(e,r,a){return!Drupal.webform.conditionalOperatorStringEmpty(e,r,a)},Drupal.webform.conditionalOperatorSelectGreaterThan=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return Drupal.webform.compare_select(t[0],a,e)>0},Drupal.webform.conditionalOperatorSelectGreaterThanEqual=function(e,r,a){var t=Drupal.webform.stringValue(e,r),o=Drupal.webform.compare_select(t[0],a,e);return o>0||0===o},Drupal.webform.conditionalOperatorSelectLessThan=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return Drupal.webform.compare_select(t[0],a,e)<0},Drupal.webform.conditionalOperatorSelectLessThanEqual=function(e,r,a){var t=Drupal.webform.stringValue(e,r),o=Drupal.webform.compare_select(t[0],a,e);return o<0||0===o},Drupal.webform.conditionalOperatorNumericEqual=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return""!==t[0]&&Math.abs(parseFloat(t[0])-parseFloat(a))<1e-6},Drupal.webform.conditionalOperatorNumericNotEqual=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return""===t[0]||Math.abs(parseFloat(t[0])-parseFloat(a))>=1e-6},Drupal.webform.conditionalOperatorNumericGreaterThan=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return parseFloat(t[0])>parseFloat(a)},Drupal.webform.conditionalOperatorNumericGreaterThanEqual=function(e,r,a){return Drupal.webform.conditionalOperatorNumericGreaterThan(e,r,a)||Drupal.webform.conditionalOperatorNumericEqual(e,r,a)},Drupal.webform.conditionalOperatorNumericLessThan=function(e,r,a){var t=Drupal.webform.stringValue(e,r);return parseFloat(t[0])<parseFloat(a)},Drupal.webform.conditionalOperatorNumericLessThanEqual=function(e,r,a){return Drupal.webform.conditionalOperatorNumericLessThan(e,r,a)||Drupal.webform.conditionalOperatorNumericEqual(e,r,a)},Drupal.webform.conditionalOperatorDateEqual=function(e,r,a){return Drupal.webform.dateValue(e,r)===a},Drupal.webform.conditionalOperatorDateNotEqual=function(e,r,a){return!Drupal.webform.conditionalOperatorDateEqual(e,r,a)},Drupal.webform.conditionalOperatorDateBefore=function(e,r,a){var t=Drupal.webform.dateValue(e,r);return!1!==t&&t<a},Drupal.webform.conditionalOperatorDateBeforeEqual=function(e,r,a){var t=Drupal.webform.dateValue(e,r);return!1!==t&&(t<a||t===a)},Drupal.webform.conditionalOperatorDateAfter=function(e,r,a){var t=Drupal.webform.dateValue(e,r);return!1!==t&&t>a},Drupal.webform.conditionalOperatorDateAfterEqual=function(e,r,a){var t=Drupal.webform.dateValue(e,r);return!1!==t&&(t>a||t===a)},Drupal.webform.conditionalOperatorTimeEqual=function(e,r,a){return Drupal.webform.timeValue(e,r)===a},Drupal.webform.conditionalOperatorTimeNotEqual=function(e,r,a){return!Drupal.webform.conditionalOperatorTimeEqual(e,r,a)},Drupal.webform.conditionalOperatorTimeBefore=function(e,r,a){var t=Drupal.webform.timeValue(e,r);return!1!==t&&t<a},Drupal.webform.conditionalOperatorTimeBeforeEqual=function(e,r,a){var t=Drupal.webform.timeValue(e,r);return!1!==t&&(t<a||t===a)},Drupal.webform.conditionalOperatorTimeAfter=function(e,r,a){var t=Drupal.webform.timeValue(e,r);return!1!==t&&t>a},Drupal.webform.conditionalOperatorTimeAfterEqual=function(e,r,a){var t=Drupal.webform.timeValue(e,r);return!1!==t&&(t>a||t===a)},Drupal.webform.compare_select=function(r,a,t){var o=[];e("option,input:radio,input:checkbox",t).each((function(){o.push(e(this).val())}));var n=o.indexOf(r),i=o.indexOf(a);return n<0||i<0?null:n-i},Drupal.webform.isVisible=function(e){return e.hasClass("webform-component-hidden")?!e.find("input").first().hasClass("webform-conditional-disabled"):0==e.closest(".webform-conditional-hidden").length},Drupal.webform.stringValue=function(r,a){var t=[];if(r){var o=e(r);if(Drupal.webform.isVisible(o)){if(o.find("input[type=checkbox]:checked,input[type=radio]:checked").each((function(){t.push(this.value)})),!t.length){var n=o.find("select").val();n&&(e.isArray(n)?t=n:t.push(n))}t.length||o.find("input:not([type=checkbox],[type=radio]),textarea").each((function(){t.push(this.value)}))}}else switch(e.type(a)){case"array":t=a;break;case"string":t.push(a)}return t},Drupal.webform.dateValue=function(r,a){var t=!1;if(r){var o=e(r);if(Drupal.webform.isVisible(o)){var n=o.find("[name*=day]").val(),i=o.find("[name*=month]").val(),l=o.find("[name*=year]").val();i&&i--,""!==l&&""!==i&&""!==n&&(t=Date.UTC(l,i,n)/1e3)}}else"array"===e.type(a)&&a.length&&(a=a[0]),"string"===e.type(a)&&(a=a.split("-")),3===a.length&&(t=Date.UTC(a[0],a[1],a[2])/1e3);return t},Drupal.webform.timeValue=function(r,a){var t=!1;if(r){var o=e(r);if(Drupal.webform.isVisible(o)){var n=o.find("[name*=hour]").val(),i=o.find("[name*=minute]").val(),l=o.find("[name*=ampm]:checked").val();n=""===n?n:parseInt(n),i=""===i?i:parseInt(i),""!==n&&(n=12===(n=n<12&&"pm"==l?n+12:n)&&"am"==l?0:n),""!==n&&""!==i&&(t=Date.UTC(1970,0,1,n,i)/1e3)}}else"array"===e.type(a)&&a.length&&(a=a[0]),"string"===e.type(a)&&(a=a.split(":")),a.length>=2&&(t=Date.UTC(1970,0,1,a[0],a[1])/1e3);return t},e.fn.webformProp=e.fn.webformProp||function(r,a){return a?e.fn.prop?this.prop(r,!0):this.attr(r,!0):e.fn.prop?this.prop(r,!1):this.removeAttr(r)},e.fn.webformVal=function(r){return this.each((function(){var a=e(this),t=a.val(),o=-1!=e.inArray(a.val(),r);"OPTION"==this.nodeName?a.webformProp("selected",!!o&&t):a.val(!!o&&[t])})),this},Drupal.webform.restripeTable=function(r){e("> tbody > tr, > tr",r).filter(":visible:odd").filter(".odd").removeClass("odd").addClass("even").end().end().filter(":visible:even").filter(".even").removeClass("even").addClass("odd")}}(jQuery);